import{a as H,c as G,g as J,l as K,m as Q,n as R,p as X}from"./chunk-WG5JEZDM.js";import{$a as P,Aa as a,Bb as i,Cb as b,Db as m,Ea as E,Eb as y,Gb as k,Hb as D,Ib as O,Ja as V,Lb as S,Ma as N,Mb as p,Oa as A,Ob as w,Pb as _,Qb as B,_a as C,ab as h,ba as f,bb as I,ca as g,cb as F,db as u,eb as n,fb as t,gb as x,kb as v,kc as L,mb as T,mc as z,nb as d,oc as q,pc as U,qc as W,xc as j,yc as Y}from"./chunk-EW5XD5AN.js";var M=class o{transform(r,e="",s=""){if(!r)return[];let c=e.trim().toLowerCase();return r.filter(l=>{let ee=!s||l.type===s,te=!c||l.description.toLowerCase().includes(c);return ee&&te})}static \u0275fac=function(e){return new(e||o)};static \u0275pipe=N({name:"transactionFilter",type:o,pure:!0})};var ie=(o,r)=>({"fa-arrow-trend-up":o,"fa-arrow-trend-down":r}),re=(o,r)=>({"bg-success":o,"bg-danger":r}),oe=(o,r)=>({"text-success":o,"text-danger":r}),$=(o,r)=>r.id;function ae(o,r){o&1&&(n(0,"div",10),x(1,"i",11),i(2," Loading transactions... "),t())}function se(o,r){if(o&1&&(n(0,"div",12),i(1),t()),o&2){let e=d();a(),m(" ",e.errorMessage," ")}}function ce(o,r){if(o&1){let e=v();n(0,"div")(1,"div",13)(2,"a",14),x(3,"i",15),t(),n(4,"p",16),i(5,"Filters"),t(),x(6,"p"),t(),n(7,"div",17)(8,"div",18)(9,"p",19),i(10,"Search Description"),t(),x(11,"i",20),n(12,"input",21),O("ngModelChange",function(c){f(e);let l=d();return D(l.query,c)||(l.query=c),g(c)}),t(),n(13,"small",6),i(14),p(15,"transactionFilter"),t()(),n(16,"div",22)(17,"p",19),i(18,"Transaction Type"),t(),n(19,"select",23),O("ngModelChange",function(c){f(e);let l=d();return D(l.typeFilter,c)||(l.typeFilter=c),g(c)}),n(20,"option",24),i(21,"All Types"),t(),n(22,"option",25),i(23,"Credit"),t(),n(24,"option",26),i(25,"Debit"),t()()()()()}if(o&2){let e=d();a(12),k("ngModel",e.query),a(2),y(" Showing ",_(15,4,e.userTransactions,e.query,e.typeFilter).length," of ",e.userTransactions.length," transactions "),a(5),k("ngModel",e.typeFilter)}}function le(o,r){o&1&&(n(0,"div",6),i(1," No transactions found. "),t())}function de(o,r){}function pe(o,r){if(o&1&&(n(0,"div",7),I(1,de,0,0,null,null,$),p(3,"transactionFilter"),t()),o&2){let e=d();a(),F(_(3,0,e.visibleTransactions,e.query,e.typeFilter))}}function me(o,r){o&1&&(n(0,"p",6),i(1,"No transactions found"),t())}function ue(o,r){if(o&1){let e=v();n(0,"div",29),T("click",function(){let c=f(e).$implicit,l=d(2);return g(l.showDetails(c))}),n(1,"div",30)(2,"div",31)(3,"div",32),x(4,"i",33),t(),n(5,"div",34)(6,"p",35),i(7),t(),n(8,"div",36)(9,"p",37),i(10),p(11,"date"),t(),n(12,"span",38),i(13),t()()()(),n(14,"div",39)(15,"p",40),i(16),p(17,"currency"),t(),n(18,"p",37),i(19),t(),n(20,"button",41),T("click",function(){let c=f(e).$implicit,l=d(2);return g(l.onDelete(c.id))}),i(21,"Delete"),t()()()()}if(o&2){let e=r.$implicit;a(4),u("ngClass",S(16,ie,e.type==="Credit",e.type!=="Credit")),a(3),b(e.description),a(3),b(w(11,9,e.date,"MMM d,y")),a(2),u("ngClass",e.type==="Credit"?"badge bg-primary":"badge bg-success"),a(),b(e.type),a(2),u("ngClass",e.type==="Credit"?"text-success":"text-danger"),a(),y(" ",e.type==="Credit"?"+":"--"," ",_(17,12,e.amount,"USD","symbol")," "),a(3),m("Transaction ID: ",e.id)}}function fe(o,r){if(o&1){let e=v();n(0,"button",42),T("click",function(){f(e);let c=d(2);return g(c.loadMore())}),i(1,"Load More"),t()}}function ge(o,r){if(o&1&&(n(0,"div",7),I(1,ue,22,19,"div",27,$),p(3,"transactionFilter"),A(4,fe,2,0,"button",28),t()),o&2){let e=d();a(),F(_(3,1,e.visibleTransactions,e.query,e.typeFilter)),a(3),u("ngIf",e.visibleCount<e.transactions.length)}}function xe(o,r){if(o&1){let e=v();n(0,"div",43),T("click",function(){f(e);let c=d();return g(c.closeDetails())}),t(),n(1,"div",44)(2,"div",45)(3,"h5",46),x(4,"i",47),i(5," Transaction Details "),t(),n(6,"button",48),T("click",function(){f(e);let c=d();return g(c.closeDetails())}),t()(),n(7,"div",49)(8,"div",50)(9,"div",51)(10,"p")(11,"strong"),i(12,"Transaction ID:"),t(),i(13),t(),n(14,"p")(15,"strong"),i(16,"Description:"),t(),i(17),t(),n(18,"p")(19,"strong"),i(20,"Type:"),t(),n(21,"span",52),i(22),t()()(),n(23,"div",51)(24,"p")(25,"strong"),i(26,"Amount:"),t(),n(27,"span",53),i(28),p(29,"currency"),t()(),n(30,"p")(31,"strong"),i(32,"Date:"),t(),i(33),p(34,"date"),t(),n(35,"p")(36,"strong"),i(37,"Time:"),t(),i(38),p(39,"date"),t()()(),x(40,"hr"),n(41,"div",50)(42,"div",51)(43,"p")(44,"strong"),i(45,"From Account:"),t(),i(46),t()(),n(47,"div",51)(48,"p")(49,"strong"),i(50,"To Account:"),t(),i(51),t()()()(),n(52,"div",54)(53,"button",55),T("click",function(){f(e);let c=d();return g(c.closeDetails())}),x(54,"i",56),i(55," Close "),t()()()}if(o&2){let e=d();a(13),m(" ",e.selectedTransaction.id),a(4),m(" ",e.selectedTransaction.description),a(4),u("ngClass",S(22,re,e.selectedTransaction.type==="Credit",e.selectedTransaction.type==="Debit")),a(),m(" ",e.selectedTransaction.type," "),a(5),u("ngClass",S(25,oe,e.selectedTransaction.type==="Credit",e.selectedTransaction.type==="Debit")),a(),y(" ",e.selectedTransaction.type==="Credit"?"+":"-"," ",B(29,11,e.selectedTransaction.amount,"USD","symbol","1.2-2")," "),a(5),m(" ",w(34,16,e.selectedTransaction.date,"fullDate")),a(5),m(" ",w(39,19,e.selectedTransaction.date,"shortTime")),a(8),m(" ",e.selectedTransaction.fromAccountNo),a(5),m(" ",e.selectedTransaction.ToAccountNo)}}var Z=class o{constructor(r,e){this.accountService=r;this.authService=e}transactions=[];userTransactions=[];userAccounts=[];query="";typeFilter="";selectedTransaction=null;visibleCount=10;isLoading=!1;errorMessage="";ngOnInit(){this.loadUserAccounts()}loadUserAccounts(){this.isLoading=!0,this.accountService.getAllAccounts().subscribe({next:r=>{this.userAccounts=r||[];let e=this.authService.getCurrentUser();e?(this.userAccounts=this.userAccounts.filter(s=>s.userId?.toString()===e.id?.toString()),this.fetchUserTransactions()):(this.errorMessage="User not logged in",this.isLoading=!1)},error:r=>{this.errorMessage="Failed to load accounts",this.isLoading=!1,console.error(r)}})}fetchUserTransactions(){this.isLoading=!0,this.accountService.getTransactions().subscribe({next:r=>{this.transactions=r||[],this.userTransactions=this.transactions.filter(e=>{let s=this.userAccounts.find(l=>l.accountNo===e.fromAccountNo),c=this.userAccounts.find(l=>l.accountNo===e.ToAccountNo);return e.description.includes("Transfer to")||e.description.includes("Transfer from")?s&&e.type==="Debit"?!0:!!(c&&e.type==="Credit"):s||c}),console.log("Filtered transactions:",{total:this.transactions.length,userTransactions:this.userTransactions.length,userAccounts:this.userAccounts.map(e=>e.accountNo)}),this.isLoading=!1},error:r=>{this.errorMessage="Failed to load transactions",this.isLoading=!1,console.error(r)}})}get visibleTransactions(){return this.userTransactions.slice(0,this.visibleCount)}loadMore(){this.visibleCount+=10}showDetails(r){this.selectedTransaction=r}closeDetails(){this.selectedTransaction=null}refreshTransactions(){this.loadUserAccounts()}onDelete(r){confirm("Are you sure you want to delete this transaction?")&&this.accountService.deleteTransaction(r).subscribe(()=>{this.transactions=this.transactions.filter(e=>e.id!==r),this.userTransactions=this.userTransactions.filter(e=>e.id!==r)})}static \u0275fac=function(e){return new(e||o)(E(Y),E(j))};static \u0275cmp=V({type:o,selectors:[["app-transactions"]],decls:26,vars:19,consts:[[1,"title","d-flex","justify-content-between","align-items-center"],[1,"container"],[1,"card-design"],["class","text-center p-3",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[4,"ngIf"],[1,"text-muted"],[1,"stack"],[1,"transactions","mt-4"],[1,"transactions-no"],[1,"text-center","p-3"],[1,"fa","fa-spinner","fa-spin"],[1,"alert","alert-danger"],[1,"d-flex"],[1,"navbar-brand","text-dark"],[1,"filter-icon","fa-solid","fa-filter"],[1,"icon-desc"],[1,"transaction-info","d-flex","col-lg-6","col-md-12","col-12","justify-content-between"],[1,"search"],[1,"info-p"],[1,"search-icon","fa-solid","fa-sm","fa-magnifying-glass"],["type","text","placeholder"," Search by description...",1,"search-field",3,"ngModelChange","ngModel"],[1,"transaction-type"],["id","transactionTypes",1,"form-select","w-auto",3,"ngModelChange","ngModel"],["value",""],["value","Credit"],["value","Debit"],[1,"transaction-item","card","p-3","mb-2"],["class","load-more",3,"click",4,"ngIf"],[1,"transaction-item","card","p-3","mb-2",3,"click"],[1,"d-flex","justify-content-between","align-items-center"],[1,"d-flex","align-items-center","gap-3"],[1,"icon"],[1,"fa-solid",3,"ngClass"],[1,"icon-info"],[1,"description","fw-bold","mb-1"],[1,"date-type","d-flex","align-items-center","gap-2"],[1,"text-muted","mb-0"],[3,"ngClass"],[1,"text-end"],[1,"fw-bold","mb-1",3,"ngClass"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"load-more",3,"click"],[1,"custom-modal-overlay",3,"click"],[1,"custom-modal","px-4","py-4"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-info-circle","me-2","mb-1"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row"],[1,"col-md-6"],[1,"badge",3,"ngClass"],[1,"h5",3,"ngClass"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-times","me-1"]],template:function(e,s){e&1&&(n(0,"div",0)(1,"div")(2,"h5"),i(3,"Transaction History"),t(),n(4,"p"),i(5,"View and filter your account transactions"),t()()(),n(6,"div",1)(7,"div",2),A(8,ae,3,0,"div",3)(9,se,2,1,"div",4)(10,ce,26,8,"div",5),t()(),C(11,le,2,0,"div",6),p(12,"transactionFilter"),P(13,pe,4,4,"div",7),n(14,"div",1)(15,"div",2)(16,"div",8)(17,"h6"),i(18,"Transactions"),t(),n(19,"p",9),i(20),p(21,"transactionFilter"),t(),C(22,me,2,0,"p",6),p(23,"transactionFilter"),P(24,ge,5,5,"div",7),t(),C(25,xe,56,28),t()()),e&2&&(a(8),u("ngIf",s.isLoading),a(),u("ngIf",s.errorMessage),a(),u("ngIf",!s.isLoading&&!s.errorMessage),a(),h(_(12,7,s.userTransactions,s.query,s.typeFilter).length===0?11:13),a(9),m("",_(21,11,s.userTransactions,s.query,s.typeFilter).length," transactions found"),a(2),h(_(23,15,s.userTransactions,s.query,s.typeFilter).length===0?22:24),a(3),h(s.selectedTransaction?25:-1))},dependencies:[W,L,z,X,Q,R,H,K,G,J,U,q,M],styles:[".title[_ngcontent-%COMP%]{margin:30px 0 0 15px;padding:auto}.title[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-weight:600;font-size:18px;line-height:4px}.title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:400;font-size:12px;color:#928f8f}.container[_ngcontent-%COMP%]{max-width:98%;margin-left:15px;font-family:Arial,sans-serif}.card-design[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:15px;margin-bottom:20px;margin-top:0;border:1px solid #e0e0e0}.filter-icon[_ngcontent-%COMP%]{margin-bottom:4px}.icon-desc[_ngcontent-%COMP%]{font-size:14px;padding-right:3px;margin-left:5px}.info-p[_ngcontent-%COMP%]{font-size:14px;font-weight:700;margin-bottom:10px}.search-field[_ngcontent-%COMP%]{font-size:14px;border-style:none;color:#c9cbcb;margin-bottom:20px;margin-left:5px}.search-field[_ngcontent-%COMP%]:hover{box-shadow:0 0 6px #a0a6acd5;border-radius:6px}.search-field[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 8px #a0a6acd5;border-radius:6px}.search[_ngcontent-%COMP%]{max-width:250px}.search-icon[_ngcontent-%COMP%]{color:#c9cbcb;margin-left:16px}.form-select[_ngcontent-%COMP%]{font-size:14px;border-style:none}.text-muted[_ngcontent-%COMP%]{color:#c9cbcb}.fa-arrow-trend-up[_ngcontent-%COMP%]{color:green;background-color:#dcfdee;padding:10px;border-radius:50%}.fa-arrow-trend-down[_ngcontent-%COMP%]{color:red;background-color:#ffdfe9;padding:10px;border-radius:50%}h6[_ngcontent-%COMP%]{font-weight:600;font-size:16px}.transactions-no[_ngcontent-%COMP%]{font-size:14px;color:#928f8f}.description[_ngcontent-%COMP%]{font-size:14px}.load-more[_ngcontent-%COMP%]{background-color:#131313;color:#fff;border:none;padding:10px 20px;text-align:center;text-decoration:none;display:inline-block;font-size:14px;margin:10px 0;cursor:pointer;border-radius:20px}.custom-modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;z-index:1040}.custom-modal[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;width:600px;max-width:90%;border-radius:10px;box-shadow:0 4px 15px #00000080;z-index:1050;padding:1rem}"]})};export{Z as Transactions};
